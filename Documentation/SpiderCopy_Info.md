
# Script Documentation: Docker Scan File Transfer

This script copies scan data generated by a Spiderfoot Docker container from within the container to a specified local directory on the host machine. The files are organized by date to facilitate daily scan storage.

## Script Overview

- **Script Name**: `spidercopy.sh`
- **Purpose**: To transfer scan files from a Docker container to a designated local directory on the host machine, organized by the current date.
- **Docker Requirement**: The script assumes Docker is installed and running, and that the user has permissions to execute Docker commands with `sudo` (if required).

## Variables

| Variable                | Description                                                                                   |
|-------------------------|-----------------------------------------------------------------------------------------------|
| `CONTAINER_NAME`        | Name of the Docker container where scans are stored.                                          |
| `CONTAINER_OUTPUT_DIR`  | Directory in the Docker container where output files are saved.                               |
| `LOCAL_SCAN_DIR`        | Local directory path where scans should be copied.                                            |
| `CURRENT_DATE`          | Current date in `YYYY-MM-DD` format, used for organizing files by date.                       |
| `LOCAL_DATE_DIR`        | The full path to the local directory for today's scans, created if it doesn’t exist.          |

## Script Breakdown

1. **Define Variables**: Sets up the container name, the output folder path in the container, and the local folder paths for storage on the host machine.

2. **Create Local Directory**: Ensures the local directory for today’s date exists within `LOCAL_SCAN_DIR`.

   ```bash
   mkdir -p "$LOCAL_DATE_DIR"
   ```

3. **Copy Files from Docker Container**: Uses `docker cp` to copy all scan data for the current date from the Docker container's output folder to the local machine’s directory for today’s date. The command requires `sudo` if the Docker installation or permissions require it.

   ```bash
   sudo docker cp "$CONTAINER_NAME:$CONTAINER_OUTPUT_DIR/$CURRENT_DATE" "$LOCAL_DATE_DIR"
   ```

4. **Confirmation Message**: Prints a confirmation message displaying the directory where the scans have been copied.

   ```bash
   echo "Scans copied to $LOCAL_DATE_DIR"
   ```

## Usage

1. **Edit Script Variables**: Ensure the variables at the top of the script are correct for your environment:
   - `CONTAINER_NAME`: The name of the container holding the scan data.
   - `CONTAINER_OUTPUT_DIR`: The directory in the container where scan data is saved.
   - `LOCAL_SCAN_DIR`: The base directory on your host machine where the scans will be copied.

2. **Run the Script**:
   ```bash
   ./spidercopy.sh
   ```

3. **Check Local Directory**: After running, the script will copy the scans to the `LOCAL_SCAN_DIR` with the current date.

## Example

With the following configuration:

- **Container Name**: `spiderfoot`
- **Container Output Folder**: `/home/spiderfoot/output`
- **Local Directory**: `~/AFSEC-Archtop/spiderfoot/scans`

Running the script on `2024-11-02` would copy files from:
```
busy_leakey:/home/spiderfoot/output/2024-11-02
```
to:
```
~/AFSEC-Archtop/spiderfoot/scans/2024-11-02
```

